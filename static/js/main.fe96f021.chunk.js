(this.webpackJsonpphotoproof=this.webpackJsonpphotoproof||[]).push([[0],{110:function(e,t,n){e.exports={thumbnail:"styles_thumbnail__3-A4h",thumbnailCell:"styles_thumbnailCell__2vFip",toolbarSelected:"styles_toolbarSelected__13Hqi",toolbarFilter:"styles_toolbarFilter__dsTk2",dropzone:"styles_dropzone__PxjSh",toolbarIcon:"styles_toolbarIcon__1xA2m",exitBtn:"styles_exitBtn__2_J1r",commentTextContainer:"styles_commentTextContainer__F6S48",titleTextarea:"styles_titleTextarea__3NmEZ",centeredContainer:"styles_centeredContainer__2vhw1"}},122:function(e,t,n){e.exports={logoutBtn:"styles_logoutBtn__2qOth"}},123:function(e,t,n){e.exports={thumbnail:"styles_thumbnail__1FJ-e"}},135:function(e,t,n){e.exports={photoIndex:"styles_photoIndex__e02gU"}},193:function(e,t,n){},194:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(19),o=n.n(r),i=n(10),l=n(122),s=n.n(l),u=(n(163),n(29)),d=n(23),j=n(4),b=n.n(j),h=n(9),m=n(12),x=n(79),p=(n(164),n(195),n(196),n(264)),O=n(140),f=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=n.length,a=0;a<e;a++)t+=n.charAt(Math.floor(Math.random()*c));return t};x.a.initializeApp({apiKey:"AIzaSyDHmQizp773R-suNhqIN1be1of5CDmZfeA",authDomain:"photo-proof-6b9c0.firebaseapp.com",projectId:"photo-proof-6b9c0",storageBucket:"photo-proof-6b9c0.appspot.com",messagingSenderId:"845535406744",appId:"1:845535406744:web:ea79f61dc4ab063be9beed",measurementId:"G-2T5LPCQMXT"});var v=x.a.auth(),g=x.a.firestore(),w=x.a.storage(),S=function(){var e=Object(h.a)(b.a.mark((function e(t,n,c){var a,r,o,i,l,s,u,d,j,h,m,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}throw new Error("missing data or files");case 2:c(1);case 3:return r=f(8),a=g.collection("collections").doc(r),e.next=7,a.get();case 7:o=e.sent;case 8:if(o.exists){e.next=3;break}case 9:return c(5),i=t.title,l=t.minSelect,s=t.maxSelect,u=t.allowComments,e.prev=11,e.next=14,a.set({title:i,dateCreated:x.a.firestore.FieldValue.serverTimestamp(),minSelect:l,maxSelect:s,allowComments:u,status:"selecting",finalComment:""});case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(11),new Error("error creating collection document: ".concat(e.t0));case 19:return c(10),d=a.collection("photos"),j=g.batch(),e.next=24,_(r,n,c);case 24:for(h=e.sent,m=0;m<h.length;m++)p=h[m],j.set(d.doc(h[m].id),p);return e.prev=26,e.next=29,j.commit();case 29:e.next=34;break;case 31:throw e.prev=31,e.t1=e.catch(26),new Error("error creating photos documents: ".concat(e.t1));case 34:return c(100),e.abrupt("return",r);case 36:case"end":return e.stop()}}),e,null,[[11,16],[26,31]])})));return function(t,n,c){return e.apply(this,arguments)}}(),C=function(){var e=Object(h.a)(b.a.mark((function e(t,n){var c,a,r,o,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.title,a=t.minSelect,r=t.maxSelect,o=t.allowComments,i=g.collection("collections").doc(n),e.prev=2,e.next=5,i.update({title:c,minSelect:a,maxSelect:r,allowComments:o,status:"selecting"});case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),new Error("error updating collection settings");case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(h.a)(b.a.mark((function e(t,n,c){var a,r,o,i,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.collection("collections").doc(t).collection("photos"),r=g.batch(),e.next=4,_(t,n,c);case 4:for(o=e.sent,i=0;i<o.length;i++)l=o[i],r.set(a.doc(o[i].id),l);return e.prev=6,e.next=9,r.commit();case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(6),new Error("error creating photos documents: ".concat(e.t0));case 14:return c(100),e.abrupt("return");case 16:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(t,n,c){return e.apply(this,arguments)}}(),_=function(){var e=Object(h.a)(b.a.mark((function e(t,n,c){var a,r,o,i,l,s,u,d,j,h,m,x,f,v,g;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],r=85/n.length,o=10,i=0;case 4:if(!(i<n.length)){e.next=30;break}if(!(n[i].size>5e5)){e.next=7;break}throw new Error("".concat(n[i].name," filesize exceeds 0.5 MB"));case 7:return l=Object(p.a)(),e.next=10,Object(O.a)(n[i],["ModifyDate"]);case 10:return s=e.sent,u=w.ref("".concat(t,"/").concat(l,".jpg")),e.next=14,u.put(n[i]);case 14:return d=e.sent,e.next=17,d.ref.getDownloadURL();case 17:j=e.sent,h=j.match(/.+?(?=.jpg\?alt=media)/),m=n[i].name.match(/.+?(?=.jpg)/),x="".concat(h,".jpg?alt=media"),f="".concat(h,"_1400x1000.webp?alt=media"),v="".concat(h,"_400x700.jpg?alt=media"),g="".concat(h,"_400x700.webp?alt=media"),a.push({id:l,filename:"".concat(m),filenameNumber:Number(n[i].name.match(/\d+/)),cloudUrl:x,cloudUrlWebp:f,thumbnail:v,thumbnailWebp:g,selected:!1,comment:"",dateTaken:s?s.ModifyDate:null}),c(o+=r);case 27:i++,e.next=4;break;case 30:return e.abrupt("return",a);case 31:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),k=function(){var e=Object(h.a)(b.a.mark((function e(t,n,c){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.collection("collections").doc(t).collection("photos").doc(n),e.prev=1,e.next=4,a.update({selected:c});case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error("failed updating selection");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n,c){return e.apply(this,arguments)}}(),I=function(){var e=Object(h.a)(b.a.mark((function e(t,n,c){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.collection("collections").doc(t).collection("photos").doc(n),e.prev=1,e.next=4,a.update({comment:c});case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error("failed updating comment");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n,c){return e.apply(this,arguments)}}(),T=function(){var e=Object(h.a)(b.a.mark((function e(t,n){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=g.collection("collections").doc(t),e.prev=1,e.next=4,c.update({status:"confirmed",finalComment:n||""});case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error("failed confirming collection");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}(),B=function(){var e=Object(h.a)(b.a.mark((function e(t,n,c){var a,r,o,i,l,s,u,d;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(1),a=g.collection("collections").doc(t).collection("photos"),r=100/n.length,o=0,e.prev=4,i=Object(m.a)(n),e.prev=6,i.s();case 8:if((l=i.n()).done){e.next=26;break}return s=l.value,u=w.ref(t),d=a.doc(s),e.next=14,u.child("".concat(s,".jpg")).delete();case 14:return e.next=16,u.child("".concat(s,"_1400x1000.webp")).delete();case 16:return e.next=18,u.child("".concat(s,"_400x700.jpg")).delete();case 18:return e.next=20,u.child("".concat(s,"_400x700.webp")).delete();case 20:return e.next=22,d.delete();case 22:c(o+=r);case 24:e.next=8;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(6),i.e(e.t0);case 31:return e.prev=31,i.f(),e.finish(31);case 34:e.next=40;break;case 36:return e.prev=36,e.t1=e.catch(4),console.error("error deleting photos",e.t1),e.abrupt("return");case 40:return e.abrupt("return");case 41:case"end":return e.stop()}}),e,null,[[4,36],[6,28,31,34]])})));return function(t,n,c){return e.apply(this,arguments)}}(),q=function(){var e=Object(h.a)(b.a.mark((function e(t,n){var c,a,r,o,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=g.collection("collections").doc(t).collection("photos"),a=g.batch(),r=Object(m.a)(n);try{for(r.s();!(o=r.n()).done;)i=o.value,a.update(c.doc(i.id),{selected:!1,comment:""})}catch(l){r.e(l)}finally{r.f()}return e.prev=4,e.next=7,a.commit();case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),new Error("error reseting photos: ".concat(e.t0));case 12:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(h.a)(b.a.mark((function e(t,n){var c,a,r,o,i,l,s,u,d,j;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(1),c=g.collection("collections").doc(t).collection("photos"),e.next=4,g.collection("collections").doc(t);case 4:return a=e.sent,e.next=7,c.get();case 7:r=e.sent,o=100/r.size,i=0,e.prev=10,l=Object(m.a)(r.docs),e.prev=12,l.s();case 14:if((s=l.n()).done){e.next=32;break}return u=s.value,d=w.ref(t),j=c.doc(u.data().id),e.next=20,d.child("".concat(u.data().id,".jpg")).delete();case 20:return e.next=22,d.child("".concat(u.data().id,"_1400x1000.webp")).delete();case 22:return e.next=24,d.child("".concat(u.data().id,"_400x700.jpg")).delete();case 24:return e.next=26,d.child("".concat(u.data().id,"_400x700.webp")).delete();case 26:return e.next=28,j.delete();case 28:n(i+=o);case 30:e.next=14;break;case 32:e.next=37;break;case 34:e.prev=34,e.t0=e.catch(12),l.e(e.t0);case 37:return e.prev=37,l.f(),e.finish(37);case 40:return e.next=42,a.delete();case 42:e.next=48;break;case 44:return e.prev=44,e.t1=e.catch(10),console.error("error deleting collection",e.t1),e.abrupt("return");case 48:return e.abrupt("return");case 49:case"end":return e.stop()}}),e,null,[[10,44],[12,34,37,40]])})));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n,c,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getting collections"),t=[],e.next=4,g.collection("collections").orderBy("dateCreated","desc").get();case 4:n=e.sent,c=Object(m.a)(n.docs),e.prev=6,r=b.a.mark((function e(){var n,c,r,o,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.value,e.next=3,g.collection("collections").doc(n.id).collection("photos").orderBy("dateTaken").get();case 3:c=e.sent,r=[],o=1,c.forEach((function(e){var t={index:o,id:e.data().id,cloudUrl:e.data().cloudUrl,cloudUrlWebp:e.data().cloudUrlWebp,thumbnail:e.data().thumbnail,thumbnailWebp:e.data().thumbnailWebp,filename:e.data().filename,filenameNumber:e.data().filenameNumber,selected:e.data().selected,comment:e.data().comment,dateTaken:e.data().dateTaken};r.push(t),o++})),i={id:n.id,title:n.data().title,dateCreated:n.data().dateCreated,minSelect:n.data().minSelect,maxSelect:n.data().maxSelect,allowComments:n.data().allowComments,status:n.data().status,finalComment:n.data().finalComment,photos:r},t.push(i);case 9:case"end":return e.stop()}}),e)})),c.s();case 9:if((a=c.n()).done){e.next=13;break}return e.delegateYield(r(),"t0",11);case 11:e.next=9;break;case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(6),c.e(e.t1);case 18:return e.prev=18,c.f(),e.finish(18);case 21:return e.abrupt("return",t);case 22:case"end":return e.stop()}}),e,null,[[6,15,18,21]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(h.a)(b.a.mark((function e(t){var n,c,a,r,o,i,l,s,u,d,j,h;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getting single collection"),e.prev=1,e.next=4,g.collection("collections").doc(t).get();case 4:return s=e.sent,e.next=7,g.collection("collections").doc(t).collection("photos").orderBy("dateTaken").get();case 7:return u=e.sent,d=[],j=1,u.forEach((function(e){var t={index:j,id:e.data().id,cloudUrl:e.data().cloudUrl,cloudUrlWebp:e.data().cloudUrlWebp,thumbnail:e.data().thumbnail,thumbnailWebp:e.data().thumbnailWebp,filename:e.data().filename,filenameNumber:e.data().filenameNumber,selected:e.data().selected,comment:e.data().comment,dateTaken:e.data().dateTaken};d.push(t),j++})),h={id:s.id,title:null===(n=s.data())||void 0===n?void 0:n.title,dateCreated:null===(c=s.data())||void 0===c?void 0:c.dateCreated,minSelect:null===(a=s.data())||void 0===a?void 0:a.minSelect,maxSelect:null===(r=s.data())||void 0===r?void 0:r.maxSelect,allowComments:null===(o=s.data())||void 0===o?void 0:o.allowComments,status:null===(i=s.data())||void 0===i?void 0:i.status,finalComment:null===(l=s.data())||void 0===l?void 0:l.finalComment,photos:d},e.abrupt("return",h);case 15:throw e.prev=15,e.t0=e.catch(1),new Error("failed getting single collection");case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(h.a)(b.a.mark((function e(t,n){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=g.collection("collections").doc(t),e.prev=1,e.next=4,c.update({status:n});case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error("failed changing collection status");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}(),E=n(123),D=n.n(E),F=n(200),W=n(245),A=n(246),L=n(247),z=n(248),M=n(249),U=n(250),Y=n(251),H=n(252),V=n(72),J=n.n(V),X=n(235),Z=n(239),K=n(240),Q=n(241),$=n(242),ee=n(243),te=n(244),ne=n(1),ce=function(e){var t=e.dialogOpen,n=e.progress,c=e.onClickCancel,a=e.onClickAgree,r=e.dialogTitle,o=e.dialogContentText;return Object(ne.jsxs)(X.a,{open:t,children:[Object(ne.jsx)(Z.a,{id:"alert-dialog-title",children:r}),Object(ne.jsxs)(K.a,{children:[Object(ne.jsx)(Q.a,{id:"alert-dialog-description",children:o}),n?Object(ne.jsx)($.a,{variant:"determinate",value:n}):null]}),Object(ne.jsxs)(ee.a,{children:[Object(ne.jsx)(te.a,{disabled:!!n,onClick:c,color:"primary",autoFocus:!0,children:"Cancel"}),Object(ne.jsx)(te.a,{disabled:!!n,onClick:a,color:"secondary",children:"Yes"})]})]})},ae=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(0),o=Object(i.a)(r,2),l=o[0],s=o[1],u=Object(c.useState)(!1),j=Object(i.a)(u,2),m=j[0],x=j[1],p=Object(c.useState)(""),O=Object(i.a)(p,2),f=O[0],v=O[1],g=Object(c.useState)(""),w=Object(i.a)(g,2),S=w[0],C=w[1],y=Object(d.f)();Object(c.useEffect)((function(){R().then((function(e){return a(e)}))}),[]);var _=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(f,s);case 2:x(!1),s(0),n&&(t=n.filter((function(e){return e.id!==f})))&&a(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(e){y.push("edit/".concat(e))};return null===n?Object(ne.jsxs)(F.a,{open:!0,children:[Object(ne.jsx)(W.a,{color:"inherit"}),"."]}):Object(ne.jsxs)("div",{children:[Object(ne.jsx)(A.a,{children:Object(ne.jsxs)(L.a,{children:[Object(ne.jsx)(z.a,{children:Object(ne.jsxs)(M.a,{children:[Object(ne.jsx)(U.a,{width:"10%",children:"first image"}),Object(ne.jsx)(U.a,{width:"30%",children:"name"}),Object(ne.jsx)(U.a,{width:"20%",children:"status"}),Object(ne.jsx)(U.a,{children:"selected photos"}),Object(ne.jsx)(U.a,{})]})}),Object(ne.jsx)(Y.a,{children:n.map((function(e){return Object(ne.jsxs)(M.a,{hover:!0,children:[Object(ne.jsx)(U.a,{onClick:function(){return k(e.id)},children:e.photos[0]?Object(ne.jsxs)("picture",{children:[Object(ne.jsx)("source",{srcSet:e.photos[0].thumbnailWebp,type:"image/webp"}),Object(ne.jsx)("img",{src:e.photos[0].thumbnail,alt:"first collection img",className:D.a.thumbnail})]}):null}),Object(ne.jsx)(U.a,{onClick:function(){return k(e.id)},children:e.title}),Object(ne.jsx)(U.a,{onClick:function(){return k(e.id)},children:e.status}),Object(ne.jsxs)(U.a,{onClick:function(){return k(e.id)},children:[(t=e.photos,t.filter((function(e){return e.selected})).length),"/",e.photos.length]}),Object(ne.jsx)(U.a,{align:"right",children:Object(ne.jsx)(H.a,{onClick:function(t){return function(e){if(x(!0),v(e),n){var t=n.find((function(t){return t.id===e}));t&&C(t.title)}}(e.id)},children:Object(ne.jsx)(J.a,{})})})]},e.id);var t}))})]})}),Object(ne.jsx)(ce,{dialogOpen:m,progress:l,onClickCancel:function(){return x(!1)},onClickAgree:_,dialogTitle:"Do you really want to delete collection '".concat(S,"'?"),dialogContentText:"Delete action cannot be reverted!"})]})},re=n(111),oe=function(){return Object(ne.jsxs)("div",{children:[Object(ne.jsx)(re.a,{variant:"h4",children:"dashboard"}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(te.a,{to:"/settings",component:u.b,variant:"outlined",children:"Settings"}),Object(ne.jsx)(te.a,{to:"/new",component:u.b,variant:"outlined",children:"Create New Collection"})]}),Object(ne.jsx)(ae,{})]})},ie=n(18),le=n(98),se=n.n(le),ue=n(31),de=n(262),je=n(266),be=n(257),he=n(265),me=n(97),xe=function(){var e=Object(ue.b)(),t=e.register,n=e.handleSubmit,a=e.watch,r=e.errors,o=e.getValues,l=e.control,s=Object(c.useState)(!1),j=Object(i.a)(s,2),m=j[0],x=j[1],p=Object(c.useState)(0),O=Object(i.a)(p,2),f=O[0],v=O[1],g=Object(c.useState)(!0),w=Object(i.a)(g,2),C=w[0],y=w[1],_=Object(d.f)(),k=a("minSelectRequired"),I=a("maxSelectRequired"),T=function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),x(!0),e.next=4,S({title:t.title,minSelect:{required:t.minSelectRequired,goal:t.minSelectGoal},maxSelect:{required:t.maxSelectRequired,goal:t.maxSelectGoal},allowComments:t.allowComments},t.files,v);case 4:n=e.sent,x(!1),y(!1),_.push("/edit/".concat(n));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return C?Object(ne.jsxs)("div",{children:[Object(ne.jsx)(te.a,{to:"/",component:u.b,variant:"outlined",children:"Cancel"}),Object(ne.jsx)(re.a,{variant:"h4",children:"new collection"}),Object(ne.jsxs)("form",{onSubmit:n(T),children:[Object(ne.jsxs)("div",{children:[Object(ne.jsx)(te.a,{color:"primary",variant:"contained",type:"submit",children:"Create"}),m?Object(ne.jsx)(de.a,{p:"3px",children:Object(ne.jsx)($.a,{variant:"determinate",value:f})}):Object(ne.jsx)(de.a,{p:"5px"})]}),Object(ne.jsx)(je.a,{name:"title",inputRef:t({required:!0,maxLength:50}),variant:"outlined",label:"Title",error:!!r.title,helperText:r.title?"Title is required":" "}),Object(ne.jsx)("div",{children:Object(ne.jsx)(be.a,{control:Object(ne.jsx)(he.a,{}),label:"Apply watermark"})}),Object(ne.jsx)("div",{children:Object(ne.jsx)(be.a,{control:Object(ne.jsx)(he.a,{name:"allowComments",inputRef:t}),label:"Allow comments"})}),Object(ne.jsx)(re.a,{variant:"subtitle1",children:"selection goals:"}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(be.a,{control:Object(ne.jsx)(he.a,{name:"minSelectRequired",inputRef:t}),label:"minimum"}),Object(ne.jsx)("div",{style:{display:k?"inline":"none"},children:Object(ne.jsx)(je.a,{name:"minSelectGoal",type:"number",variant:"outlined",size:"small",InputProps:{inputProps:{max:999,min:1}},inputRef:t({min:"1",max:"999",valueAsNumber:!0,validate:{lowerThanMax:function(e){return!o("maxSelectRequired")||o("maxSelectGoal")>=e}}}),error:!!r.minSelectGoal,helperText:r.minSelectGoal&&"Must be higher than maximum value"})})]}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(be.a,{control:Object(ne.jsx)(he.a,{name:"maxSelectRequired",inputRef:t}),label:"maximum"}),Object(ne.jsx)("div",{style:{display:I?"inline":"none"},children:Object(ne.jsx)(je.a,{name:"maxSelectGoal",type:"number",variant:"outlined",size:"small",InputProps:{inputProps:{max:999,min:1}},inputRef:t({min:"1",max:"999",valueAsNumber:!0,validate:{higherThanMin:function(e){return!o("minSelectRequired")||o("minSelectGoal")<=e}}}),error:!!r.maxSelectGoal,helperText:r.maxSelectGoal&&"Must be higher than minimum value"})})]}),Object(ne.jsx)(ue.a,{name:"files",control:l,render:function(e){var t=e.onChange;return Object(ne.jsx)(me.a,{acceptedFiles:["image/jpeg"],dropzoneText:"Drop images or click to upload here",onChange:function(e){return console.log(e),t(Object(ie.a)(e))},filesLimit:999,previewGridClasses:{container:se.a.previewContainer,item:"".concat(se.a.previewItem," itemReference"),image:se.a.previewImage},previewGridProps:{container:{spacing:1},item:{sm:2,lg:1,md:1}},showAlerts:!1,showPreviewsInDropzone:!1,showPreviews:!0,showFileNamesInPreview:!0,dropzoneClass:"dropzoneClass"})}})]})]}):Object(ne.jsxs)(F.a,{open:!0,children:[Object(ne.jsx)(W.a,{color:"inherit"}),"."]})},pe=function(){return Object(ne.jsxs)("div",{children:[Object(ne.jsx)(u.b,{to:"/",children:Object(ne.jsx)("button",{children:"home"})}),Object(ne.jsx)("h2",{children:"settings"}),Object(ne.jsxs)("form",{children:[Object(ne.jsxs)("div",{children:["grid width",Object(ne.jsx)("input",{type:"number"})]}),Object(ne.jsxs)("div",{children:["upload watermark",Object(ne.jsx)("input",{type:"file"})]}),Object(ne.jsxs)("div",{children:["watermark size, px",Object(ne.jsx)("input",{min:"0",type:"number"})]}),Object(ne.jsxs)("div",{children:["watermark angle, deg",Object(ne.jsx)("input",{min:"0",max:"360",type:"number"})]}),Object(ne.jsx)("div",{children:Object(ne.jsx)("button",{children:"save"})})]})]})},Oe=function(){var e=Object(ue.b)(),t=e.register,n=e.handleSubmit,c=e.errors,a=e.setError,r=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.signInWithEmailAndPassword(t.email,t.password);case 3:e.next=10;break;case 5:e.prev=5,e.t0=e.catch(0),a("email",{message:" "}),a("password",{message:"Email or password is incorrect"}),console.error("error signin in with password and email",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}();return Object(ne.jsxs)("div",{children:[Object(ne.jsx)(re.a,{variant:"h4",children:"Sign In"}),Object(ne.jsx)(de.a,{mt:3,children:Object(ne.jsxs)("form",{onSubmit:n(r),children:[Object(ne.jsx)("div",{children:Object(ne.jsx)(je.a,{variant:"outlined",name:"email",label:"Email",inputRef:t({required:!0}),error:!!c.email,helperText:c.email?c.email.message||"Email is required":" "})}),Object(ne.jsx)("div",{children:Object(ne.jsx)(je.a,{type:"password",variant:"outlined",name:"password",label:"Password",inputRef:t({required:!0}),error:!!c.password,helperText:c.password?c.password.message||"Password is required":" "})}),Object(ne.jsx)("div",{children:Object(ne.jsx)(te.a,{type:"submit",variant:"outlined",children:"Sign in"})})]})})]})},fe=n(256),ve=n(268),ge=n(263),we=n(269),Se=n(138),Ce=n.n(Se),ye=n(53),_e=n.n(ye),ke=n(61),Ie=n.n(ke),Te=n(78),Be=n.n(Te),qe=n(84),Ne=n.n(qe),Re=n(60),Ge=n.n(Re),Pe=n(135),Ee=n.n(Pe),De=n(100),Fe=n(136),We=function(e){var t=e.filteredPhotos,n=e.setLightboxOpen,c=e.lightboxIndex,a=e.setLightboxIndex,r=e.toolbarButtons;return Object(ne.jsx)(Fe.a,{mainSrc:De.isWebpSupported?t[c].cloudUrlWebp:t[c].cloudUrl,nextSrc:De.isWebpSupported?t[(c+1)%t.length].cloudUrlWebp:t[(c+1)%t.length].cloudUrl,prevSrc:De.isWebpSupported?t[(c+t.length-1)%t.length].cloudUrlWebp:t[(c+t.length-1)%t.length].cloudUrl,onCloseRequest:function(){return n(!1)},onMovePrevRequest:function(){return a((c+t.length-1)%t.length)},onMoveNextRequest:function(){return a((c+1)%t.length)},toolbarButtons:r,enableZoom:!1,imageTitle:Object(ne.jsxs)(re.a,{classes:{root:Ee.a.photoIndex},children:[t[c].index,"."]})})},Ae=function(e){var t=e.collection,n=e.filteredPhotos,c=e.lightboxOpen,a=e.setLightboxOpen,r=e.openLightbox,o=e.openCommentModal,i=e.photoIndex,l=e.setPhotoIndex,s=e.commentOpen,u=e.setCommentOpen,d=e.commentTextarea;return Object(ne.jsxs)("div",{children:[Object(ne.jsx)("div",{className:_e.a.photoGrid,children:n.map((function(e,n){return Object(ne.jsx)("div",{className:_e.a.photoThumbnailGrid,children:Object(ne.jsxs)("div",{className:_e.a.imgBorder,children:[Object(ne.jsxs)("picture",{children:[Object(ne.jsx)("source",{srcSet:e.thumbnailWebp,type:"image/webp"}),Object(ne.jsx)("img",{src:e.thumbnail,alt:t.title,onClick:r(Number(n))})]}),e.comment.length>0&&t.allowComments?Object(ne.jsx)(H.a,{className:_e.a.commentBtnFilled,onClick:function(){return o(n)},children:Object(ne.jsx)(Ge.a,{})}):null,e.selected?Object(ne.jsx)(H.a,{className:_e.a.starBtnSelected,children:Object(ne.jsx)(Be.a,{})}):null]})},e.id)}))}),c&&n.length>0&&Object(ne.jsx)(We,{filteredPhotos:n,setLightboxOpen:a,lightboxIndex:i,setLightboxIndex:l,toolbarButtons:[Object(ne.jsx)(H.a,{children:n[i].selected?Object(ne.jsx)(Be.a,{className:_e.a.toolbarIcon}):Object(ne.jsx)(Ie.a,{className:_e.a.toolbarIcon})}),t.allowComments?Object(ne.jsx)(H.a,{onClick:function(){return o()},children:n[i].comment.length>0?Object(ne.jsx)(Ge.a,{className:_e.a.toolbarIcon}):Object(ne.jsx)(Ne.a,{className:_e.a.toolbarIcon})}):null]}),Object(ne.jsxs)(X.a,{open:s,onClose:function(){return u(!1)},children:[Object(ne.jsx)(Z.a,{id:"alert-dialog-title",children:"Comment"}),Object(ne.jsx)(K.a,{children:Object(ne.jsx)(je.a,{multiline:!0,rows:4,variant:"outlined",value:d,disabled:!0})})]})]})},Le=n(21),ze=n(42),Me=n.n(ze),Ue=function(e){var t=e.collection,n=e.setCollection,a=e.collectionId,r=e.filteredPhotos,o=e.lightboxOpen,l=e.setLightboxOpen,s=e.openLightbox,u=e.openCommentModal,d=e.photoIndex,j=e.setPhotoIndex,m=e.commentOpen,x=e.setCommentOpen,p=e.commentTextarea,O=e.setCommentTextarea,f=e.selectedPhotos,v=Object(c.useState)(!1),g=Object(i.a)(v,2),w=g[0],S=g[1],C=Object(ue.b)({defaultValues:{files:[]}}),y=C.register,_=C.handleSubmit,B=Object(c.useState)(!1),q=Object(i.a)(B,2),N=q[0],R=q[1],G=function(){var e=Object(h.a)(b.a.mark((function e(c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(c),e.next=3,T(a,c.finalComment);case 3:S(!1),n(Object(Le.a)(Object(Le.a)({},t),{},{status:"confirmed",finalComment:c.finalComment}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(ne.jsxs)("div",{children:[Object(ne.jsx)("div",{className:Me.a.photoGrid,children:r.map((function(e,c){return Object(ne.jsx)("div",{className:Me.a.photoThumbnailGrid,children:Object(ne.jsxs)("div",{className:Me.a.imgBorder,children:[Object(ne.jsxs)("picture",{children:[Object(ne.jsx)("source",{srcSet:e.thumbnailWebp,type:"image/webp"}),Object(ne.jsx)("img",{src:e.thumbnail,alt:t.title,onClick:s(Number(c))})]}),t.allowComments?Object(ne.jsx)(H.a,{className:e.comment.length>0?Me.a.commentBtnFilled:Me.a.commentBtn,onClick:function(){return u(c)},children:e.comment.length>0?Object(ne.jsx)(Ge.a,{}):Object(ne.jsx)(Ne.a,{})}):null,Object(ne.jsx)(H.a,{className:e.selected?Me.a.starBtnSelected:Me.a.starBtn,onClick:(r=e.id,function(e){try{var c=null===t||void 0===t?void 0:t.photos.find((function(e){return e.id===r}));c&&t&&(k(a,r,!c.selected),c.selected=!(null===c||void 0===c?void 0:c.selected),n(Object(Le.a)(Object(Le.a)({},t),{},{photos:t.photos.map((function(e){return e.id===r?c:e}))})))}catch(o){}}),children:e.selected?Object(ne.jsx)(Be.a,{}):Object(ne.jsx)(Ie.a,{})})]})},e.id);var r}))}),o&&r.length>0&&Object(ne.jsx)(We,{filteredPhotos:r,setLightboxOpen:l,lightboxIndex:d,setLightboxIndex:j,toolbarButtons:[Object(ne.jsx)(H.a,{onClick:function(){if(r&&t)try{var e=r[d];e&&t&&(k(a,e.id,!e.selected),e.selected=!(null===e||void 0===e?void 0:e.selected),n(Object(Le.a)(Object(Le.a)({},t),{},{photos:t.photos.map((function(t){return t.id===e.id?e:t}))})))}catch(c){console.error(c)}},children:r[d].selected?Object(ne.jsx)(Be.a,{className:Me.a.toolbarIcon}):Object(ne.jsx)(Ie.a,{className:Me.a.toolbarIcon})}),t.allowComments?Object(ne.jsx)(H.a,{onClick:function(){return u()},children:r[d].comment.length>0?Object(ne.jsx)(Ge.a,{className:Me.a.toolbarIcon}):Object(ne.jsx)(Ne.a,{className:Me.a.toolbarIcon})}):null]}),Object(ne.jsxs)(X.a,{open:m,onClose:function(){return x(!1)},children:[Object(ne.jsx)(Z.a,{id:"alert-dialog-title",children:"Comment"}),Object(ne.jsx)(K.a,{children:Object(ne.jsx)(je.a,{multiline:!0,rows:4,variant:"outlined",value:p,onChange:function(e){e.preventDefault(),O(e.target.value)}})}),Object(ne.jsxs)(ee.a,{children:[Object(ne.jsx)(te.a,{onClick:function(){return x(!1)},color:"secondary",autoFocus:!0,children:"Cancel"}),Object(ne.jsx)(te.a,{onClick:function(){if(x(!1),r&&t)try{var e=r[d];e&&t&&(I(a,e.id,p),e.comment=p,n(Object(Le.a)(Object(Le.a)({},t),{},{photos:t.photos.map((function(t){return t.id===e.id?e:t}))})))}catch(c){console.error(c)}},color:"primary",children:"Save"})]})]}),Object(ne.jsx)(te.a,{variant:"contained",classes:{root:Me.a.fixedBtn},onClick:function(){return f&&(t.minSelect.required&&f<t.minSelect.goal||t.maxSelect.required&&f>t.maxSelect.goal)?R(!0):S(!0)},children:"Confirm selections"}),Object(ne.jsxs)(X.a,{open:N,onClose:function(){return R(!1)},children:[Object(ne.jsx)(Z.a,{id:"alert-dialog-title",children:"Please adjust your selections!"}),Object(ne.jsx)(K.a,{children:Object(ne.jsxs)(Q.a,{children:["You have selected ",Object(ne.jsx)("strong",{children:f})," photos, but"," ",t.minSelect.required&&t.maxSelect.required?Object(ne.jsxs)("span",{children:["you must select"," ",Object(ne.jsxs)("strong",{children:["from ",t.minSelect.goal," to"," ",t.maxSelect.goal]})," ","photos."]}):t.minSelect.required&&!t.maxSelect.required?Object(ne.jsxs)("span",{children:["you must select"," ",Object(ne.jsxs)("strong",{children:["at least ",t.minSelect.goal]})," photos."]}):!t.minSelect.required&&t.maxSelect.required?Object(ne.jsxs)("span",{children:["you must select"," ",Object(ne.jsxs)("strong",{children:["a maximum of ",t.maxSelect.goal]})," ","photos."]}):null," "]})}),Object(ne.jsx)(ee.a,{children:Object(ne.jsx)(te.a,{onClick:function(){return R(!1)},color:"primary",autoFocus:!0,children:"Cancel"})})]}),Object(ne.jsx)(X.a,{open:w,onClose:function(){return S(!1)},children:Object(ne.jsxs)("form",{onSubmit:_(G),children:[Object(ne.jsx)(Z.a,{id:"alert-dialog-title",children:"Confirm selections"}),Object(ne.jsxs)(K.a,{children:[Object(ne.jsxs)(Q.a,{children:["You have selected ",Object(ne.jsxs)("strong",{children:[f," photos"]}),"."]}),Object(ne.jsx)(Q.a,{children:"Do you want to leave a final comment?"}),Object(ne.jsx)(je.a,{multiline:!0,rows:3,fullWidth:!0,variant:"outlined",placeholder:"Final comment",name:"finalComment",inputRef:y}),Object(ne.jsxs)(Q.a,{children:[Object(ne.jsx)("strong",{children:"Warning:"})," you will not be able to select more photos after confirming!"]})]}),Object(ne.jsxs)(ee.a,{children:[Object(ne.jsx)(te.a,{onClick:function(){return S(!1)},color:"secondary",autoFocus:!0,children:"Cancel"}),Object(ne.jsx)(te.a,{type:"submit",color:"primary",children:"Confirm"})]})]})})]})},Ye=function(){var e=Object(d.g)().id,t=Object(c.useState)(null),n=Object(i.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)([]),l=Object(i.a)(o,2),s=l[0],u=l[1],j=Object(c.useState)("all"),b=Object(i.a)(j,2),h=b[0],m=b[1],x=Object(c.useState)(!1),p=Object(i.a)(x,2),O=p[0],f=p[1],v=Object(c.useState)(0),g=Object(i.a)(v,2),w=g[0],S=g[1],C=Object(c.useState)(""),y=Object(i.a)(C,2),_=y[0],k=y[1],I=Object(c.useState)(!1),T=Object(i.a)(I,2),B=T[0],q=T[1];Object(c.useEffect)((function(){G(e).then((function(e){r(e),u(e.photos)}))}),[e]),Object(c.useEffect)((function(){if(a)switch(h){case"all":return u(a.photos);case"selected":var e=a.photos.filter((function(e){return e.selected}));return 0===e.length?f(!1):e.length<=w&&S(e.length-1),u(e);case"unselected":var t=a.photos.filter((function(e){return!e.selected}));return 0===t.length?f(!1):t.length<=w&&S(t.length-1),u(t)}}),[h,a]);var N=function(e){q(!0),s&&(e?(S(e),k(s[e].comment)):k(s[w].comment))},R=function(e){return function(t){S(e),f(!0)}},P=null===a||void 0===a?void 0:a.photos.filter((function(e){return e.selected})).length;return null===a?Object(ne.jsxs)(F.a,{open:!0,children:[Object(ne.jsx)(W.a,{color:"inherit"}),"."]}):Object(ne.jsxs)("div",{children:[Object(ne.jsxs)(re.a,{variant:"h4",children:[a.title," ","selecting"!==a.status&&Object(ne.jsx)(Ce.a,{})]}),Object(ne.jsxs)(re.a,{variant:"h6",children:["Selected: ",P]}),a.minSelect.required&&a.maxSelect.required?Object(ne.jsxs)(re.a,{children:["You must select from ",a.minSelect.goal," to"," ",a.maxSelect.goal," photos"]}):a.minSelect.required&&!a.maxSelect.required?Object(ne.jsxs)(re.a,{children:["You must select at least ",a.minSelect.goal," photos"]}):!a.minSelect.required&&a.maxSelect.required?Object(ne.jsxs)(re.a,{children:["You must select a maximum of ",a.maxSelect.goal," photos"]}):null,Object(ne.jsxs)(fe.a,{children:[Object(ne.jsx)(ve.a,{children:"Filter"}),Object(ne.jsxs)(ge.a,{value:h,onChange:function(e){m(e.target.value)},children:[Object(ne.jsx)(we.a,{value:"all",children:"All"}),Object(ne.jsx)(we.a,{value:"selected",children:"Selected"}),Object(ne.jsx)(we.a,{value:"unselected",children:"Unselected"})]})]}),0===a.photos.length?Object(ne.jsx)("div",{children:"no photos in collection"}):0===s.length?Object(ne.jsx)("div",{children:"no photos in this filter"}):null,"selecting"===a.status?Object(ne.jsx)(Ue,{collection:a,setCollection:r,collectionId:e,filteredPhotos:s,lightboxOpen:O,setLightboxOpen:f,openLightbox:R,openCommentModal:N,photoIndex:w,setPhotoIndex:S,commentOpen:B,setCommentOpen:q,commentTextarea:_,setCommentTextarea:k,selectedPhotos:P}):Object(ne.jsx)(Ae,{collection:a,filteredPhotos:s,lightboxOpen:O,setLightboxOpen:f,openLightbox:R,openCommentModal:N,photoIndex:w,setPhotoIndex:S,commentOpen:B,setCommentOpen:q,commentTextarea:_})]})},He=n(32),Ve=n.n(He),Je=n(259),Xe=n(270),Ze=n(198),Ke=n(73),Qe=n.n(Ke),$e=n(110),et=n.n($e),tt=function(e){var t=e.collectionId,n=e.collection,a=e.setCollection,r=e.filteredPhotos,o=e.setConfirmationDialogOpen,l=e.setConfirmationDialogTitle,s=e.setConfirmationDialogContentText,d=e.setConfirmationDialogAgree,j=e.setProgress,m=Object(c.useState)(!1),x=Object(i.a)(m,2),p=x[0],O=x[1],f=Object(ue.b)(),v=f.register,g=f.handleSubmit,w=f.watch,S=f.errors,y=f.getValues,_=f.setValue,k=f.reset,I=f.control,T=w("minSelectRequired"),B=w("maxSelectRequired");Object(c.useEffect)((function(){n&&(k({title:n.title,allowComments:n.allowComments,maxSelectRequired:n.maxSelect.required,minSelectRequired:n.minSelect.required,minSelectGoal:n.minSelect.goal,maxSelectGoal:n.maxSelect.goal}),_("allowComments",!0))}),[n,k]);var q=function(){var e=Object(h.a)(b.a.mark((function e(c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P(t,c);case 3:n&&a(Object(Le.a)(Object(Le.a)({},n),{},{status:c})),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:G();case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(h.a)(b.a.mark((function e(c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C({title:c.title,minSelect:{required:c.minSelectRequired,goal:c.minSelectGoal},maxSelect:{required:c.maxSelectRequired,goal:c.maxSelectGoal},allowComments:c.allowComments},t);case 3:n&&a(Object(Le.a)(Object(Le.a)({},n),{},{title:c.title,minSelect:{required:c.minSelectRequired,goal:c.minSelectGoal},maxSelect:{required:c.maxSelectRequired,goal:c.maxSelectGoal},allowComments:c.allowComments,status:"selecting"})),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),R=function(e){if(n){var t=n.photos.filter((function(e){return e.selected})).map((function(e){return e.filename}));navigator.clipboard.writeText(t.join(" "))}O(!0),setTimeout((function(){O(!1)}),2e3),G()},G=function(){o(!1),l(""),s(""),d((function(){})),j(0)},E=null===n||void 0===n?void 0:n.photos.filter((function(e){return e.selected})).length;return null===n||null===r?Object(ne.jsxs)(F.a,{open:!0,children:[Object(ne.jsx)(W.a,{color:"inherit"}),"."]}):Object(ne.jsxs)("div",{children:[Object(ne.jsxs)("form",{onSubmit:g(N),children:["editing"!==n.status?Object(ne.jsx)(te.a,{variant:"outlined",onClick:"confirmed"===n.status?function(){o(!0),l("This collection is already confirmed"),s("Do you really want to edit an already confirmed collection?"),d((function(){return function(){return q("editing")}}))}:function(){return q("editing")},children:"Edit"}):Object(ne.jsx)(te.a,{color:"primary",variant:"contained",type:"submit",children:"Save"}),"editing"===n.status?Object(ne.jsx)("div",{children:Object(ne.jsx)(je.a,{label:"Title",name:"title",defaultValue:n.title,variant:"outlined",classes:{root:et.a.titleTextarea},margin:"dense",inputRef:v({required:!0,maxLength:50}),error:!!S.title,helperText:S.title?"Title is required":" "})}):Object(ne.jsx)(re.a,{variant:"h4",children:n.title}),Object(ne.jsxs)(re.a,{children:["Client URL:"," ",Object(ne.jsx)(Xe.a,{title:p?"copied!":"copy",children:Object(ne.jsxs)(te.a,{onClick:function(e){var t=e.target;navigator.clipboard.writeText(t.innerHTML),O(!0),setTimeout((function(){O(!1)}),2e3)},children:["".concat(window.location.origin.toString(),"/collection/").concat(t)," "]})}),Object(ne.jsx)(te.a,{to:"/collection/".concat(t),component:u.b,variant:"outlined",size:"small",children:"View"})]}),Object(ne.jsxs)(re.a,{children:["Status: ",n.status," "]}),"confirmed"===n.status?Object(ne.jsxs)(re.a,{children:["Final comment: ",n.finalComment]}):null,Object(ne.jsx)(re.a,{variant:"h6",children:"Settings:"}),Object(ne.jsx)("div",{children:Object(ne.jsx)(be.a,{control:Object(ne.jsx)(ue.a,{control:I,name:"allowComments",render:function(e,t){var c=e.onChange,a=e.onBlur,r=e.value,o=(e.name,e.ref);t.invalid,t.isTouched,t.isDirty;return Object(ne.jsx)(he.a,{onBlur:a,onChange:function(e){return c(e.target.checked)},checked:r,inputRef:o,disabled:"editing"!==n.status})}}),label:"Allow comments"})}),Object(ne.jsx)(re.a,{variant:"subtitle1",children:"selection goals:"}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(be.a,{control:Object(ne.jsx)(ue.a,{control:I,name:"minSelectRequired",render:function(e,t){var c=e.onChange,a=e.onBlur,r=e.value,o=(e.name,e.ref);t.invalid,t.isTouched,t.isDirty;return Object(ne.jsx)(he.a,{onBlur:a,onChange:function(e){return c(e.target.checked)},checked:r,inputRef:o,disabled:"editing"!==n.status})}}),label:"minimum"}),Object(ne.jsx)("div",{style:{display:T?"inline":"none"},children:Object(ne.jsx)(je.a,{name:"minSelectGoal",type:"number",variant:"outlined",size:"small",InputProps:{inputProps:{max:999,min:1}},inputRef:v({min:"1",max:"999",valueAsNumber:!0,validate:{lowerThanMax:function(e){return!y("maxSelectRequired")||y("maxSelectGoal")>=e}}}),error:!!S.minSelectGoal,helperText:S.minSelectGoal&&"Must be higher than maximum value",disabled:"editing"!==n.status})})]}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(be.a,{control:Object(ne.jsx)(ue.a,{control:I,name:"maxSelectRequired",render:function(e,t){var c=e.onChange,a=e.onBlur,r=e.value,o=(e.name,e.ref);t.invalid,t.isTouched,t.isDirty;return Object(ne.jsx)(he.a,{onBlur:a,onChange:function(e){return c(e.target.checked)},checked:r,inputRef:o,disabled:"editing"!==n.status})}}),label:"maximum"}),Object(ne.jsx)("div",{style:{display:B?"inline":"none"},children:Object(ne.jsx)(je.a,{name:"maxSelectGoal",type:"number",variant:"outlined",size:"small",InputProps:{inputProps:{max:999,min:1}},inputRef:v({min:"1",max:"999",valueAsNumber:!0,validate:{higherThanMin:function(e){return!y("minSelectRequired")||y("minSelectGoal")<=e}}}),error:!!S.maxSelectGoal,helperText:S.maxSelectGoal&&"Must be higher than minimum value",disabled:"editing"!==n.status})})]})]}),Object(ne.jsxs)(Ze.a,{elevation:3,className:et.a.centeredContainer,children:[Object(ne.jsx)(re.a,{variant:"h6",children:"Selected:"}),Object(ne.jsxs)(re.a,{variant:"subtitle1",children:[E,"/",n.photos.length]}),Object(ne.jsx)(Xe.a,{title:p?"copied!":"copy",children:Object(ne.jsx)(te.a,{onClick:"confirmed"===n.status?R:function(){o(!0),l("This collection is not yet confirmed"),s("Do you really want to copy selections from an unconfirmed collection?"),d((function(){return R}))},variant:"outlined",children:"Copy selections"})})]})]})},nt=n(258),ct=function(e){var t=e.photo,n=e.children,a=e.width,r=e.height,o=Object(c.useState)(!1),l=Object(i.a)(o,2),s=l[0],u=l[1],d=Object(c.useState)(!1),j=Object(i.a)(d,2),b=j[0],h=j[1];return Object(c.useEffect)((function(){fetch(t.cloudUrlWebp,{}).then((function(e){if(e.ok)u(!0);else var n=1,c=setInterval((function(){fetch(t.cloudUrlWebp,{}).then((function(e){console.log("trie :>> ",n),console.log(e),e.ok?(clearInterval(c),u(!0)):n>10&&(console.log("set failed"),h(!0)),n+=1}))}),500)}))}),[]),b?Object(ne.jsx)("div",{style:{width:a,height:r,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(ne.jsx)(Qe.a,{})}):s?Object(ne.jsx)("div",{children:n}):Object(ne.jsx)(nt.a,{variant:"rect",width:a,height:r})},at=function(){var e=Object(d.g)().id,t=Object(c.useState)(null),n=Object(i.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(null),l=Object(i.a)(o,2),s=l[0],j=l[1],x=Object(c.useState)("all"),p=Object(i.a)(x,2),O=p[0],f=p[1],v=Object(c.useState)(0),g=Object(i.a)(v,2),w=g[0],S=g[1],C=Object(c.useState)(!1),_=Object(i.a)(C,2),k=_[0],I=_[1],T=Object(c.useState)([]),N=Object(i.a)(T,2),R=N[0],P=N[1],E=Object(c.useState)(!1),D=Object(i.a)(E,2),V=D[0],Q=D[1],ae=Object(c.useState)(""),oe=Object(i.a)(ae,2),le=oe[0],se=oe[1],je=Object(c.useState)(""),be=Object(i.a)(je,2),xe=be[0],pe=be[1],Oe=Object(c.useState)((function(){})),Se=Object(i.a)(Oe,2),Ce=Se[0],ye=Se[1],_e=Object(c.useState)(0),ke=Object(i.a)(_e,2),Te=ke[0],Be=ke[1],qe=Object(c.useState)(!1),Ne=Object(i.a)(qe,2),Re=Ne[0],Pe=Ne[1],Ee=Object(c.useState)(!1),De=Object(i.a)(Ee,2),Fe=De[0],Ae=De[1],ze=Object(c.useState)(""),Me=Object(i.a)(ze,2),Ue=Me[0],Ye=Me[1];Object(c.useEffect)((function(){k?document.body.style.overflow="hidden":k||(document.body.style.overflow="unset")}),[k]);var He=Object(ue.b)({defaultValues:{files:[]}}),Ke=He.handleSubmit,$e=(He.errors,He.control);Object(c.useEffect)((function(){G(e).then((function(e){r(e),j(e.photos)}))}),[e]);Object(c.useEffect)((function(){if(a)switch(O){case"all":return j(a.photos);case"selected":var e=a.photos.filter((function(e){return e.selected}));return j(e);case"unselected":var t=a.photos.filter((function(e){return!e.selected}));return j(t)}}),[O,a]);var et=function(e){return function(t){S(e),I(!0)}},nt=function(e){return-1!==R.indexOf(e)},at=function(){var t=Object(h.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B(e,R,Be);case 2:a&&(n=a.photos.filter((function(e){var t,n=Object(m.a)(R);try{for(n.s();!(t=n.n()).done;){var c=t.value;if(e.id===c)return!1}}catch(a){n.e(a)}finally{n.f()}return!0})).map((function(e,t){return Object(Le.a)(Object(Le.a)({},e),{},{index:t+1})})),r(Object(Le.a)(Object(Le.a)({},a),{},{photos:n}))),P([]),it();case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),rt=function(){var t=Object(h.a)(b.a.mark((function t(n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n),t.next=3,y(e,n.files,Be);case 3:Pe(!1),Be(0),G(e).then((function(e){r(e)}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ot=function(){var t=Object(h.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=10;break}return t.prev=1,t.next=4,q(e,a.photos);case 4:r(Object(Le.a)(Object(Le.a)({},a),{},{photos:a.photos.map((function(e){return Object(Le.a)(Object(Le.a)({},e),{},{selected:!1,comment:""})}))})),it(),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(1);case 10:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}(),it=function(){Q(!1),se(""),pe(""),ye((function(){})),Be(0)};return null===a||null===s?Object(ne.jsxs)(F.a,{open:!0,children:[Object(ne.jsx)(W.a,{color:"inherit"}),"."]}):Object(ne.jsxs)("div",{children:[Object(ne.jsx)(te.a,{to:"/",component:u.b,variant:"outlined",children:"Home"}),Object(ne.jsx)(tt,{collectionId:e,collection:a,setCollection:r,filteredPhotos:s,setConfirmationDialogOpen:Q,setConfirmationDialogTitle:se,setConfirmationDialogContentText:pe,setConfirmationDialogAgree:ye,setProgress:Be}),Object(ne.jsxs)(Je.a,{children:[R.length>0?Object(ne.jsxs)("div",{className:Ve.a.toolbarSelected,children:[Object(ne.jsxs)(re.a,{color:"inherit",component:"div",children:[R.length," to be deleted"]}),Object(ne.jsx)(Xe.a,{title:"Delete",children:Object(ne.jsx)(H.a,{"aria-label":"delete",onClick:function(){Q(!0),se("Do you really want to delete these photos?"),pe("WARNING: Delete action cannot be reverted!"),ye((function(){return at}))},children:Object(ne.jsx)(J.a,{})})})]}):Object(ne.jsx)("div",{className:Ve.a.toolbarSelected,children:"editing"===a.status?Object(ne.jsxs)("div",{children:[Object(ne.jsx)(te.a,{onClick:function(){Pe(!0)},variant:"outlined",children:"Add photos"}),Object(ne.jsx)(te.a,{onClick:function(){Q(!0),se("Do you really want to reset all selections and comments?"),pe("WARNING: Reset action cannot be reverted!"),ye((function(){return ot}))},variant:"outlined",children:"Reset selections and comments"})]}):null}),Object(ne.jsxs)(fe.a,{className:Ve.a.toolbarFilter,children:[Object(ne.jsx)(ve.a,{children:"Filter"}),Object(ne.jsxs)(ge.a,{value:O,onChange:function(e){f(e.target.value)},children:[Object(ne.jsx)(we.a,{value:"all",children:"All"}),Object(ne.jsx)(we.a,{value:"selected",children:"Selected"}),Object(ne.jsx)(we.a,{value:"unselected",children:"Unselected"})]})]})]}),Object(ne.jsx)(A.a,{children:Object(ne.jsxs)(L.a,{size:"small",children:[Object(ne.jsx)(z.a,{children:Object(ne.jsxs)(M.a,{children:["editing"===a.status?Object(ne.jsx)(U.a,{padding:"checkbox",children:Object(ne.jsx)(he.a,{indeterminate:R.length>0&&R.length<s.length,checked:s.length>0&&R.length===s.length,onChange:function(e){if(e.target.checked&&s){var t=s.map((function(e){return e.id}));P(t)}else P([])}})}):null,Object(ne.jsx)(U.a,{width:"5%",children:"no."}),Object(ne.jsx)(U.a,{width:"10%",children:"thumbnail"}),Object(ne.jsx)(U.a,{width:"30%",children:"filename"}),Object(ne.jsx)(U.a,{padding:"checkbox"}),Object(ne.jsx)(U.a,{children:"comment"})]})}),Object(ne.jsx)(Y.a,{children:s.map((function(e,t){return Object(ne.jsxs)(M.a,{selected:nt(e.id),hover:!0,children:["editing"===a.status?Object(ne.jsx)(U.a,{padding:"checkbox",onClick:function(t){return function(e,t){var n=R.indexOf(t),c=[];-1===n?c=c.concat(R,t):0===n?c=c.concat(R.slice(1)):n===R.length-1?c=c.concat(R.slice(0,-1)):n>0&&(c=c.concat(R.slice(0,n),R.slice(n+1))),P(c)}(0,e.id)},children:Object(ne.jsx)(he.a,{checked:nt(e.id)})}):null,Object(ne.jsxs)(U.a,{children:[e.index,"."]}),Object(ne.jsx)(U.a,{padding:"none",children:Object(ne.jsx)(ct,{photo:e,width:150,height:100,children:Object(ne.jsxs)("picture",{children:[Object(ne.jsx)("source",{srcSet:e.thumbnailWebp,type:"image/webp"}),Object(ne.jsx)("img",{src:e.thumbnail,alt:a.title,className:Ve.a.thumbnail,onClick:et(t)})]})})}),Object(ne.jsx)(U.a,{children:e.filename}),Object(ne.jsx)(U.a,{padding:"checkbox",children:e.selected?Object(ne.jsx)(Ie.a,{}):null}),Object(ne.jsx)(U.a,{children:e.comment})]},e.id)}))})]})}),k&&s.length>0&&Object(ne.jsx)(We,{filteredPhotos:s,setLightboxOpen:I,lightboxIndex:w,setLightboxIndex:S,toolbarButtons:[s[w].comment.length>0?Object(ne.jsx)(H.a,{className:Ve.a.toolbarIcon,onClick:function(){return Ae(!0),void(s&&(e?(S(e),Ye(s[e].comment)):Ye(s[w].comment)));var e},children:Object(ne.jsx)(Ge.a,{})}):Object(ne.jsx)("div",{className:Ve.a.toolbarIcon}),s[w].selected?Object(ne.jsx)(H.a,{className:Ve.a.toolbarIcon,disabled:!0,children:Object(ne.jsx)(Ie.a,{})}):Object(ne.jsx)("div",{className:Ve.a.toolbarIcon})]}),Object(ne.jsx)(ce,{dialogOpen:V,progress:Te,onClickCancel:function(){return Q(!1)},onClickAgree:Ce,dialogTitle:le,dialogContentText:xe}),Object(ne.jsx)(X.a,{open:Re,children:Object(ne.jsxs)("form",{onSubmit:Ke(rt),children:[Object(ne.jsx)(Z.a,{id:"alert-dialog-title",children:"Add photos"}),Object(ne.jsxs)(K.a,{children:[Te?Object(ne.jsx)(de.a,{p:"3px",children:Object(ne.jsx)($.a,{variant:"determinate",value:Te})}):Object(ne.jsx)(de.a,{p:"5px"}),Object(ne.jsx)(ue.a,{name:"files",control:$e,render:function(e){var t=e.onChange;return Object(ne.jsx)(me.a,{acceptedFiles:["image/jpeg"],dropzoneText:"Drop images or click to upload here",onChange:function(e){return t(Object(ie.a)(e))},filesLimit:999,previewGridClasses:{container:Ve.a.previewContainer,item:"".concat(Ve.a.previewItem," itemReference"),image:Ve.a.previewImage},previewGridProps:{container:{spacing:1},item:{sm:2,lg:2,md:2}},showAlerts:!1,showPreviewsInDropzone:!1,showPreviews:!0,showFileNamesInPreview:!0,dropzoneClass:Ve.a.dropzone})}})]}),Object(ne.jsxs)(ee.a,{children:[Object(ne.jsx)(te.a,{disabled:!!Te,onClick:function(){return Pe(!1)},color:"secondary",children:"Cancel"}),Object(ne.jsx)(te.a,{disabled:!!Te,color:"primary",type:"submit",children:"Yes"})]})]})}),Object(ne.jsxs)(X.a,{open:Fe,onClose:function(){return Ae(!1)},children:[Object(ne.jsx)(H.a,{onClick:function(){return Ae(!1)},className:Ve.a.exitBtn,children:Object(ne.jsx)(Qe.a,{})}),Object(ne.jsx)(Z.a,{id:"alert-dialog-title",children:"Comment"}),Object(ne.jsxs)(K.a,{children:[Object(ne.jsx)(Ze.a,{className:Ve.a.commentTextContainer,elevation:3,children:Object(ne.jsx)(re.a,{children:Ue})}),Object(ne.jsx)(ee.a,{})]})]})]})},rt=n(260);var ot=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!0),o=Object(i.a)(r,2),l=o[0],j=o[1];return Object(c.useEffect)((function(){v.onAuthStateChanged((function(e){a(e?e.uid:null),j(!1)}))}),[]),l?Object(ne.jsxs)(F.a,{open:!0,children:[Object(ne.jsx)(W.a,{color:"inherit"}),"."]}):Object(ne.jsxs)(rt.a,{children:[Object(ne.jsx)(re.a,{variant:"h2",children:"photoproof"}),n&&Object(ne.jsx)("div",{className:s.a.logoutBtn,children:Object(ne.jsx)(te.a,{onClick:function(){return v.signOut()},variant:"outlined",children:"Logout"})}),Object(ne.jsx)(u.a,{children:Object(ne.jsxs)(d.c,{children:[Object(ne.jsx)(d.a,{path:"/collection/:id",render:function(){return Object(ne.jsx)(Ye,{})}}),n?null:Object(ne.jsx)(d.a,{path:"/",render:function(){return Object(ne.jsx)(Oe,{})}}),Object(ne.jsx)(d.a,{path:"/settings",render:function(){return Object(ne.jsx)(pe,{})}}),Object(ne.jsx)(d.a,{path:"/new",render:function(){return Object(ne.jsx)(xe,{})}}),Object(ne.jsx)(d.a,{path:"/edit/:id",render:function(){return Object(ne.jsx)(at,{})}}),Object(ne.jsx)(d.a,{path:"/",render:function(){return Object(ne.jsx)(oe,{})}})]})})]})};n(193);o.a.render(Object(ne.jsx)(a.a.StrictMode,{children:Object(ne.jsx)(ot,{})}),document.getElementById("root"))},32:function(e,t,n){e.exports={thumbnail:"styles_thumbnail__HuAYR",thumbnailCell:"styles_thumbnailCell__39WOG",toolbarSelected:"styles_toolbarSelected__zaouI",toolbarFilter:"styles_toolbarFilter__6jQJx",dropzone:"styles_dropzone__2eWfI",toolbarIcon:"styles_toolbarIcon__2Fpfe",exitBtn:"styles_exitBtn___ClFY",commentTextContainer:"styles_commentTextContainer__DJpY9",titleTextarea:"styles_titleTextarea__1TicK",centeredContainer:"styles_centeredContainer__3Ecro"}},42:function(e,t,n){e.exports={photoGrid:"styles_photoGrid__3YaHx",photoThumbnailGrid:"styles_photoThumbnailGrid__16eVO",imgBorder:"styles_imgBorder__3r9lS",starBtn:"styles_starBtn__3c3O8",starBtnSelected:"styles_starBtnSelected__3aRF6",commentBtn:"styles_commentBtn__31sU8",commentBtnFilled:"styles_commentBtnFilled__HHfWH",toolbarIcon:"styles_toolbarIcon__3OnpN",fixedBtn:"styles_fixedBtn__EOXbc"}},53:function(e,t,n){e.exports={photoGrid:"styles_photoGrid__1VPui",photoThumbnailGrid:"styles_photoThumbnailGrid__3hTKt",imgBorder:"styles_imgBorder__mXHoL",starBtn:"styles_starBtn__1kZeR",starBtnSelected:"styles_starBtnSelected__2Mxa_",commentBtn:"styles_commentBtn__250mx",commentBtnFilled:"styles_commentBtnFilled__2CXgB",toolbarIcon:"styles_toolbarIcon__3uSyR",fixedBtn:"styles_fixedBtn__2tdMg"}},98:function(e,t,n){e.exports={previewItem:"styles_previewItem__3IX2a",previewImage:"styles_previewImage__2J3BL"}}},[[194,1,2]]]);
//# sourceMappingURL=main.fe96f021.chunk.js.map