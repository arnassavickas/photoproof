[{"D:\\Projektai\\photoproof\\src\\index.tsx":"1","D:\\Projektai\\photoproof\\src\\App.tsx":"2","D:\\Projektai\\photoproof\\src\\utils\\makeId.tsx":"3","D:\\Projektai\\photoproof\\src\\firebase.tsx":"4","D:\\Projektai\\photoproof\\src\\types.ts":"5","D:\\Projektai\\photoproof\\src\\components\\Dashboard\\Dashboard.tsx":"6","D:\\Projektai\\photoproof\\src\\components\\NewCollectionPage\\NewCollection.tsx":"7","D:\\Projektai\\photoproof\\src\\components\\SignIn\\SignIn.tsx":"8","D:\\Projektai\\photoproof\\src\\components\\Settings\\Settings.tsx":"9","D:\\Projektai\\photoproof\\src\\components\\CollectionPage\\CollectionPage.tsx":"10","D:\\Projektai\\photoproof\\src\\components\\Dashboard\\CollectionsList\\CollectionsList.tsx":"11","D:\\Projektai\\photoproof\\src\\components\\EditCollection\\EditCollection.tsx":"12","D:\\Projektai\\photoproof\\src\\components\\ConfirmationDialog\\ConfirmationDialog.tsx":"13","D:\\Projektai\\photoproof\\src\\components\\ImageLoader\\ImageLoader.tsx":"14","D:\\Projektai\\photoproof\\src\\components\\Lightbox\\Lightbox.tsx":"15","D:\\Projektai\\photoproof\\src\\components\\CollectionPage\\LockedView\\LockedView.tsx":"16","D:\\Projektai\\photoproof\\src\\components\\CollectionPage\\SelectionView\\SelectionView.tsx":"17","D:\\Projektai\\photoproof\\src\\components\\EditCollection\\CollectionDetails\\CollectionDetails.tsx":"18","D:\\Projektai\\photoproof\\src\\config.js":"19"},{"size":220,"mtime":1613212981658,"results":"20","hashOfConfig":"21"},{"size":2013,"mtime":1613220540258,"results":"22","hashOfConfig":"21"},{"size":336,"mtime":1611690852583,"results":"23","hashOfConfig":"21"},{"size":12040,"mtime":1613218859384,"results":"24","hashOfConfig":"21"},{"size":400,"mtime":1611941595334,"results":"25","hashOfConfig":"26"},{"size":615,"mtime":1613216539250,"results":"27","hashOfConfig":"21"},{"size":6331,"mtime":1612986774573,"results":"28","hashOfConfig":"21"},{"size":1870,"mtime":1613213530003,"results":"29","hashOfConfig":"21"},{"size":863,"mtime":1613213669217,"results":"30","hashOfConfig":"21"},{"size":5628,"mtime":1612958039377,"results":"31","hashOfConfig":"21"},{"size":4818,"mtime":1612892510769,"results":"32","hashOfConfig":"21"},{"size":15751,"mtime":1613216505200,"results":"33","hashOfConfig":"21"},{"size":1368,"mtime":1613074880667,"results":"34","hashOfConfig":"21"},{"size":1610,"mtime":1613214015067,"results":"35","hashOfConfig":"21"},{"size":2092,"mtime":1612963557557,"results":"36","hashOfConfig":"21"},{"size":3312,"mtime":1612963531722,"results":"37","hashOfConfig":"21"},{"size":10457,"mtime":1612968155218,"results":"38","hashOfConfig":"21"},{"size":11508,"mtime":1613216451813,"results":"39","hashOfConfig":"21"},{"size":347,"mtime":1613218699310,"results":"40","hashOfConfig":"21"},{"filePath":"41","messages":"42","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1bosnlm",{"filePath":"43","messages":"44","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"45","messages":"46","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"48","messages":"49","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"50","messages":"51","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1jl4ilk",{"filePath":"52","messages":"53","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"54","messages":"55","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"56","messages":"57","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"58","messages":"59","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"60","messages":"61","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"62","messages":"63","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"64","messages":"65","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"66","usedDeprecatedRules":"47"},{"filePath":"67","messages":"68","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"69","messages":"70","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"71","messages":"72","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"73","messages":"74","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"75","messages":"76","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"77","messages":"78","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"47"},{"filePath":"79","messages":"80","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"D:\\Projektai\\photoproof\\src\\index.tsx",[],"D:\\Projektai\\photoproof\\src\\App.tsx",[],"D:\\Projektai\\photoproof\\src\\utils\\makeId.tsx",[],["81","82"],"D:\\Projektai\\photoproof\\src\\firebase.tsx",[],"D:\\Projektai\\photoproof\\src\\types.ts",[],"D:\\Projektai\\photoproof\\src\\components\\Dashboard\\Dashboard.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\NewCollectionPage\\NewCollection.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\SignIn\\SignIn.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\Settings\\Settings.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\CollectionPage\\CollectionPage.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\Dashboard\\CollectionsList\\CollectionsList.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\EditCollection\\EditCollection.tsx",["83"],"import React, { useEffect, useState } from 'react';\nimport styles from './styles.module.scss';\nimport { useParams, Link } from 'react-router-dom';\nimport { Collection, Photo } from '../../types';\nimport {\n  getSingleCollection,\n  deletePhotos,\n  addMorePhotos,\n  resetPhotos,\n} from '../../firebase';\nimport {\n  FormControl,\n  InputLabel,\n  MenuItem,\n  Select,\n  Checkbox,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Toolbar,\n  IconButton,\n  Typography,\n  Tooltip,\n  Backdrop,\n  CircularProgress,\n  Button,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  LinearProgress,\n  Box,\n  Paper,\n} from '@material-ui/core';\n\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport MessageIcon from '@material-ui/icons/Message';\nimport CloseIcon from '@material-ui/icons/Close';\n\nimport ConfirmationDialog from '../ConfirmationDialog/ConfirmationDialog';\nimport { DropzoneArea } from 'material-ui-dropzone';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport CollectionDetails from './CollectionDetails/CollectionDetails';\nimport ImageLoader from '../ImageLoader/ImageLoader';\nimport Lightbox from '../Lightbox/Lightbox';\n\nconst EditCollection: React.FC = () => {\n  const { id: collectionId } = useParams<{ id: string }>();\n\n  const [collection, setCollection] = useState<Collection | null>(null);\n  const [filteredPhotos, setFilteredPhotos] = useState<Photo[] | null>(null);\n  const [filter, setFilter] = useState('all');\n  const [photoIndex, setPhotoIndex] = useState(0);\n  const [lightboxOpen, setLightboxOpen] = useState(false);\n  const [selected, setSelected] = useState<string[]>([]);\n\n  const [confirmationDialogOpen, setConfirmationDialogOpen] = useState(false);\n  const [confirmationDialogTitle, setConfirmationDialogTitle] = useState('');\n  const [\n    confirmationDialogContentText,\n    setConfirmationDialogContentText,\n  ] = useState('');\n  const [confirmationDialogAgree, setConfirmationDialogAgree] = useState<\n    (value: any) => void\n  >(() => {});\n  const [progress, setProgress] = useState(0);\n\n  const [addPhotosDialogOpen, setAddPhotosDialogOpen] = useState(false);\n  const [commentOpen, setCommentOpen] = useState(false);\n  const [commentTextarea, setCommentTextarea] = useState('');\n\n  useEffect(() => {\n    if (lightboxOpen) {\n      document.body.style.overflow = 'hidden';\n    } else if (!lightboxOpen) {\n      document.body.style.overflow = 'unset';\n    }\n  }, [lightboxOpen]);\n\n  const {\n    handleSubmit: handleSubmitFiles,\n    //TODO add error if no files added to upload\n    errors: errorsFiles,\n    control: controlFiles,\n  } = useForm<any>({\n    defaultValues: { files: [] },\n  });\n\n  useEffect(() => {\n    getSingleCollection(collectionId).then((collection) => {\n      setCollection(collection);\n      setFilteredPhotos(collection.photos);\n    });\n  }, [collectionId]);\n\n  const changeFilter = (e: React.ChangeEvent<{ value: unknown }>) => {\n    setFilter(e.target.value as string);\n  };\n\n  useEffect(() => {\n    if (collection) {\n      switch (filter) {\n        case 'all':\n          return setFilteredPhotos(collection.photos);\n        case 'selected':\n          const selectedPhotos = collection.photos.filter(\n            (photo) => photo.selected\n          );\n          return setFilteredPhotos(selectedPhotos);\n        case 'unselected':\n          const unselectedPhotos = collection.photos.filter(\n            (photo) => !photo.selected\n          );\n          return setFilteredPhotos(unselectedPhotos);\n      }\n    }\n  }, [filter, collection]);\n\n  const openLightbox = (index: number) => (event: any) => {\n    setPhotoIndex(index);\n    setLightboxOpen(true);\n  };\n\n  const handleSelectAllClick = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.checked && filteredPhotos) {\n      const newSelecteds = filteredPhotos.map((n) => n.id);\n      setSelected(newSelecteds);\n      return;\n    }\n    setSelected([]);\n  };\n\n  const handleClick = (event: React.MouseEvent<unknown>, id: string) => {\n    const selectedIndex = selected.indexOf(id);\n    let newSelected: string[] = [];\n\n    if (selectedIndex === -1) {\n      newSelected = newSelected.concat(selected, id);\n    } else if (selectedIndex === 0) {\n      newSelected = newSelected.concat(selected.slice(1));\n    } else if (selectedIndex === selected.length - 1) {\n      newSelected = newSelected.concat(selected.slice(0, -1));\n    } else if (selectedIndex > 0) {\n      newSelected = newSelected.concat(\n        selected.slice(0, selectedIndex),\n        selected.slice(selectedIndex + 1)\n      );\n    }\n    setSelected(newSelected);\n  };\n\n  const isSelected = (id: string) => selected.indexOf(id) !== -1;\n\n  const agreeDelete = async () => {\n    await deletePhotos(collectionId, selected, setProgress);\n    if (collection) {\n      const removeDeleted = collection.photos\n        .filter((photo) => {\n          for (let id of selected) {\n            if (photo.id === id) {\n              return false;\n            }\n          }\n          return true;\n        })\n        .map((photo, index) => {\n          return { ...photo, index: index + 1 };\n        });\n      setCollection({\n        ...collection,\n        photos: removeDeleted,\n      });\n    }\n    setSelected([]);\n    resetDialog();\n  };\n\n  const onConfirmUpload = async (data: { files: FileList }) => {\n    console.log(data);\n    await addMorePhotos(collectionId, data.files, setProgress);\n    setAddPhotosDialogOpen(false);\n    setProgress(0);\n    getSingleCollection(collectionId).then((collection) => {\n      setCollection(collection);\n    });\n  };\n\n  const openCommentModal = (index?: number) => {\n    setCommentOpen(true);\n    if (filteredPhotos) {\n      if (index) {\n        setPhotoIndex(index);\n        setCommentTextarea(filteredPhotos[index].comment);\n      } else {\n        setCommentTextarea(filteredPhotos[photoIndex].comment);\n      }\n    }\n  };\n\n  const agreeResetPhotos = async () => {\n    if (collection) {\n      try {\n        await resetPhotos(collectionId, collection.photos);\n        setCollection({\n          ...collection,\n          photos: collection.photos.map((photo) => ({\n            ...photo,\n            selected: false,\n            comment: '',\n          })),\n        });\n        resetDialog();\n      } catch (err) {\n        //\n      }\n    }\n  };\n\n  const confirmDeletion = () => {\n    setConfirmationDialogOpen(true);\n    setConfirmationDialogTitle('Do you really want to delete these photos?');\n    setConfirmationDialogContentText(\n      'WARNING: Delete action cannot be reverted!'\n    );\n    setConfirmationDialogAgree(() => agreeDelete);\n  };\n\n  const confirmResetPhotos = () => {\n    setConfirmationDialogOpen(true);\n    setConfirmationDialogTitle(\n      'Do you really want to reset all selections and comments?'\n    );\n    setConfirmationDialogContentText(\n      'WARNING: Reset action cannot be reverted!'\n    );\n    setConfirmationDialogAgree(() => agreeResetPhotos);\n  };\n\n  const resetDialog = () => {\n    setConfirmationDialogOpen(false);\n    setConfirmationDialogTitle('');\n    setConfirmationDialogContentText('');\n    setConfirmationDialogAgree(() => {});\n    setProgress(0);\n  };\n\n  if (collection === null || filteredPhotos === null) {\n    return (\n      <Backdrop open={true}>\n        <CircularProgress color='inherit' />.\n      </Backdrop>\n    );\n  }\n\n  return (\n    <div>\n      <Button to='/' component={Link} variant='outlined'>\n        Home\n      </Button>\n      <CollectionDetails\n        collectionId={collectionId}\n        collection={collection}\n        setCollection={setCollection}\n        filteredPhotos={filteredPhotos}\n        setConfirmationDialogOpen={setConfirmationDialogOpen}\n        setConfirmationDialogTitle={setConfirmationDialogTitle}\n        setConfirmationDialogContentText={setConfirmationDialogContentText}\n        setConfirmationDialogAgree={setConfirmationDialogAgree}\n        setProgress={setProgress}\n      />\n      <Toolbar>\n        {selected.length > 0 ? (\n          <div className={styles.toolbarSelected}>\n            <Typography color='inherit' component='div'>\n              {selected.length} to be deleted\n            </Typography>\n            <Tooltip title='Delete'>\n              <IconButton aria-label='delete' onClick={confirmDeletion}>\n                <DeleteIcon />\n              </IconButton>\n            </Tooltip>\n          </div>\n        ) : (\n          <div className={styles.toolbarSelected}>\n            {collection.status === 'editing' ? (\n              <div>\n                <Button\n                  onClick={() => {\n                    setAddPhotosDialogOpen(true);\n                  }}\n                  variant='outlined'\n                >\n                  Add photos\n                </Button>\n                <Button onClick={confirmResetPhotos} variant='outlined'>\n                  Reset selections and comments\n                </Button>\n              </div>\n            ) : null}\n          </div>\n        )}\n        <FormControl className={styles.toolbarFilter}>\n          <InputLabel>Filter</InputLabel>\n          <Select value={filter} onChange={changeFilter}>\n            <MenuItem value={'all'}>All</MenuItem>\n            <MenuItem value={'selected'}>Selected</MenuItem>\n            <MenuItem value={'unselected'}>Unselected</MenuItem>\n          </Select>\n        </FormControl>\n      </Toolbar>\n      <TableContainer>\n        <Table size='small'>\n          <TableHead>\n            <TableRow>\n              {collection.status === 'editing' ? (\n                <TableCell padding='checkbox'>\n                  <Checkbox\n                    indeterminate={\n                      selected.length > 0 &&\n                      selected.length < filteredPhotos.length\n                    }\n                    checked={\n                      filteredPhotos.length > 0 &&\n                      selected.length === filteredPhotos.length\n                    }\n                    onChange={handleSelectAllClick}\n                  />\n                </TableCell>\n              ) : null}\n              <TableCell width='5%'>no.</TableCell>\n              <TableCell width='10%'>thumbnail</TableCell>\n              <TableCell width='30%'>filename</TableCell>\n              <TableCell padding='checkbox'></TableCell>\n              <TableCell>comment</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {filteredPhotos.map((photo, index) => (\n              <TableRow\n                key={photo.id}\n                selected={isSelected(photo.id)}\n                hover={true}\n              >\n                {collection.status === 'editing' ? (\n                  <TableCell\n                    padding='checkbox'\n                    onClick={(event) => handleClick(event, photo.id)}\n                  >\n                    <Checkbox checked={isSelected(photo.id)} />\n                  </TableCell>\n                ) : null}\n                <TableCell>{photo.index}.</TableCell>\n                <TableCell padding='none'>\n                  <ImageLoader photo={photo} width={150} height={100}>\n                    <picture>\n                      <source srcSet={photo.thumbnailWebp} type='image/webp' />\n                      <img\n                        src={photo.thumbnail}\n                        alt={collection.title}\n                        className={styles.thumbnail}\n                        onClick={openLightbox(index)}\n                      />\n                    </picture>\n                  </ImageLoader>\n                </TableCell>\n                <TableCell>{photo.filename}</TableCell>\n                <TableCell padding='checkbox'>\n                  {photo.selected ? <StarBorderIcon /> : null}\n                </TableCell>\n                <TableCell>{photo.comment}</TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n      {lightboxOpen && filteredPhotos.length > 0 && (\n        <Lightbox\n          filteredPhotos={filteredPhotos}\n          setLightboxOpen={setLightboxOpen}\n          lightboxIndex={photoIndex}\n          setLightboxIndex={setPhotoIndex}\n          toolbarButtons={[\n            filteredPhotos[photoIndex].comment.length > 0 ? (\n              <IconButton\n                className={styles.toolbarIcon}\n                onClick={() => openCommentModal()}\n              >\n                <MessageIcon />\n              </IconButton>\n            ) : (\n              <div className={styles.toolbarIcon}></div>\n            ),\n            filteredPhotos[photoIndex].selected ? (\n              <IconButton className={styles.toolbarIcon} disabled>\n                <StarBorderIcon />\n              </IconButton>\n            ) : (\n              <div className={styles.toolbarIcon}></div>\n            ),\n          ]}\n        />\n      )}\n      <ConfirmationDialog\n        dialogOpen={confirmationDialogOpen}\n        progress={progress}\n        onClickCancel={() => setConfirmationDialogOpen(false)}\n        onClickAgree={confirmationDialogAgree}\n        dialogTitle={confirmationDialogTitle}\n        dialogContentText={confirmationDialogContentText}\n      />\n      <Dialog open={addPhotosDialogOpen}>\n        <form onSubmit={handleSubmitFiles(onConfirmUpload)}>\n          <DialogTitle id='alert-dialog-title'>Add photos</DialogTitle>\n          <DialogContent>\n            {progress ? (\n              <Box p={'3px'}>\n                <LinearProgress variant='determinate' value={progress} />\n              </Box>\n            ) : (\n              <Box p={'5px'}></Box>\n            )}\n            <Controller\n              name='files'\n              control={controlFiles}\n              render={({ onChange }) => (\n                <DropzoneArea\n                  acceptedFiles={['image/jpeg']}\n                  dropzoneText={'Drop images or click to upload here'}\n                  onChange={(files) => {\n                    return onChange([...files]);\n                  }}\n                  filesLimit={999}\n                  previewGridClasses={{\n                    container: styles.previewContainer,\n                    item: `${styles.previewItem} itemReference`,\n                    image: styles.previewImage,\n                  }}\n                  previewGridProps={{\n                    container: {\n                      spacing: 1,\n                    },\n                    item: { sm: 2, lg: 2, md: 2 },\n                  }}\n                  showAlerts={false}\n                  showPreviewsInDropzone={false}\n                  showPreviews={true}\n                  showFileNamesInPreview={true}\n                  dropzoneClass={styles.dropzone}\n                />\n              )}\n            />\n          </DialogContent>\n          <DialogActions>\n            <Button\n              disabled={!!progress}\n              onClick={() => setAddPhotosDialogOpen(false)}\n              color='secondary'\n            >\n              Cancel\n            </Button>\n            <Button disabled={!!progress} color='primary' type='submit'>\n              Yes\n            </Button>\n          </DialogActions>\n        </form>\n      </Dialog>\n      <Dialog open={commentOpen} onClose={() => setCommentOpen(false)}>\n        <IconButton\n          onClick={() => setCommentOpen(false)}\n          className={styles.exitBtn}\n        >\n          <CloseIcon />\n        </IconButton>\n        <DialogTitle id='alert-dialog-title'>Comment</DialogTitle>\n        <DialogContent>\n          <Paper className={styles.commentTextContainer} elevation={3}>\n            <Typography>{commentTextarea}</Typography>\n          </Paper>\n          <DialogActions></DialogActions>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n};\n\nexport default EditCollection;\n","D:\\Projektai\\photoproof\\src\\components\\ConfirmationDialog\\ConfirmationDialog.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\ImageLoader\\ImageLoader.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\Lightbox\\Lightbox.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\CollectionPage\\LockedView\\LockedView.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\CollectionPage\\SelectionView\\SelectionView.tsx",[],"D:\\Projektai\\photoproof\\src\\components\\EditCollection\\CollectionDetails\\CollectionDetails.tsx",[],"D:\\Projektai\\photoproof\\src\\config.js",[],{"ruleId":"84","replacedBy":"85"},{"ruleId":"86","replacedBy":"87"},{"ruleId":"88","severity":1,"message":"89","line":88,"column":13,"nodeType":"90","messageId":"91","endLine":88,"endColumn":24},"no-native-reassign",["92"],"no-negated-in-lhs",["93"],"@typescript-eslint/no-unused-vars","'errorsFiles' is assigned a value but never used.","Identifier","unusedVar","no-global-assign","no-unsafe-negation"]